---
slug: useraccounts-script
id: ucoyyjpxk6jv
type: challenge
title: Use Command Line Assistant to perform repetitive tasks
teaser: We'll use Command Line Assistant to complete a repetitive task, such as creating
  user accounts.
notes:
- type: text
  contents: Command Line Assistant can be used to automate repetitive tasks. CLA can
    help you author shell scripts to perform actions in bulk. In this assignment we'll
    use CLA to create a script to create user accounts.
tabs:
- id: i5jlyzt8f2kg
  title: rhel
  type: terminal
  hostname: rhel
- id: sfuxkslgvsng
  title: Editor
  type: code
  hostname: rhel
  path: /root/createuser.sh
difficulty: ""
lab_config:
  custom_layout: '{"root":{"children":[{"branch":{"size":62,"children":[{"leaf":{"tabs":["i5jlyzt8f2kg"],"activeTabId":"i5jlyzt8f2kg","size":49}},{"leaf":{"tabs":["sfuxkslgvsng"],"activeTabId":"sfuxkslgvsng","size":49}}]}},{"leaf":{"tabs":["assignment"],"activeTabId":"assignment","size":36}}],"orientation":"Horizontal"}}'
enhanced_loading: null
---
It may be the case that you will have to perform a repetitive task, such as creating user accounts, at least once in your life. Command Line Assistant can help you reduce the burden of such a task.

Comma Separated Value input file
===
In this challenge we've provided a comma separated value (csv) file containing usernames and preferred terminal shells.

You can take a look here.
```bash,run
cat ~/users.csv
```

We'll ask CLA to create a shell script to take the file `users.csv` as input and create users with their preferred shells.

Create the script
===
It's important to be very specific when asking CLA to write any sort of code. For exmample, we'll run the following request.
```bash,run
c "write a script that creates user accounts using a csv input file containing usernames and preferred shells"
```

Here's the result, at the time that this lab was written.
![](../assets/bash_script.png)

>[!NOTE]
> Command line assistant (CLA) makes use of a large language model (LLM) as well as a Retrieval Augmented Generation (RAG) database, generated from the corpus of Red Hat's knowledge base. Responses from CLA can vary, depending on the progress of training the LLM. It may be the case that you'll need to refine your question to CLA to obtain an accurate answer, especially if your question asks CLA to generate code such as a shell script.

Below is the output script generated by CLA at the time this lab was written. You can copy and paste this into `/root/createuser.sh` into the built-in text editor.

```bash
#!/bin/bash

# Check if the script is run as root
if [ "$(id -u)" -ne 0 ]; then
  echo "This script must be run as root."
  exit 1
fi

# Check if the CSV file is provided as an argument
if [ -z "$1" ]; then
  echo "Usage: $0 <path_to_csv_file>"
  exit 1
fi

# CSV file path
CSV_FILE="$1"

# Read the CSV file
while IFS=',' read -r username shell; do
  # Create user with specified shell
  useradd -m -s "$shell" "$username"

  # Optionally, set a password for the user
  # echo "$username:$password" | chpasswd

  echo "User $username created with shell $shell"
done < "$CSV_FILE"
```

Run the script to create the new accounts
===

Run the script.
```bash,run
/root/createuser.sh users.csv
```

Let's check `/etc/passwd` to see if the new accounts were created.

```bash,run
cat /etc/passwd
```

Here's what the output should look like.

![](../assets/user_accounts.png)

Let's check that home directories were created.

```bash,run
ls -lart /home
```

![](../assets/directories.png)